module: FinalComprehensiveTestFixed
    import: std_io
    import: syscall.time
    
    struct: Point
        fields:
            declare x: int
            declare y: int
        
        init:
            params:
                declare xVal: int
                declare yVal: int
            body:
                this.x = xVal
                this.y = yVal
            end body
        end init
        
        function: getX
            returns: int
            body:
                return this.x
            end body
        end function
        
        function: getY
            returns: int
            body:
                return this.y
            end body
        end function
        
        function: move
            params:
                declare dx: int
                declare dy: int
            returns: void
            body:
                this.x = this.x + dx
                this.y = this.y + dy
            end body
        end function
    end struct
    
    struct: ColoredPoint extends Point
        fields:
            declare color: string
        
        init:
            params:
                declare xVal: int
                declare yVal: int
                declare c: string
            body:
                super(xVal, yVal)
                this.color = c
            end body
        end init
        
        function: getColor
            returns: string
            body:
                return this.color
            end body
        end function
        
        function: move
            params:
                declare dx: int
                declare dy: int
            returns: void
            body:
                super.move(dx, dy)
                std_io.println("Moving " + this.color + " point")
            end body
        end function
    end struct
    
    globals:
        declare globalCounter: int = 0
        declare _privateGlobal: string = "Private"
    
    function: main
        returns: void
        body:
            std_io.println("=== Final Comprehensive Snow Language Test ===")
            
            // 测试基本数据类型
            testBasicTypes()
            
            // 测试控制结构
            testControlStructures()
            
            // 测试函数
            testFunctions()
            
            // 测试结构体
            testStructs()
            
            // 测试继承
            testInheritance()
            
            // 测试数组
            testArrays()
            
            // 测试多维数组
            testMultidimensionalArrays()
            
            // 测试系统调用
            testSyscalls()
            
            // 测试全局变量
            testGlobals()
            
            // 测试访问控制
            testAccessControl()
            
            std_io.println("=== All tests completed successfully! ===")
        end body
    end function
    
    function: testBasicTypes
        returns: void
        body:
            std_io.println("--- Testing Basic Types ---")
            declare b: byte = 127
            declare s: short = 32767
            declare i: int = 2147483647
            declare l: long = 9223372036854775807L
            declare f: float = 3.14159f
            declare d: double = 3.141592653589793
            declare bool: boolean = true
            declare str: string = "Hello Snow"
            
            std_io.println("byte: " + b)
            std_io.println("short: " + s)
            std_io.println("int: " + i)
            std_io.println("long: " + l)
            std_io.println("float: " + f)
            std_io.println("double: " + d)
            std_io.println("boolean: " + bool)
            std_io.println("string: " + str)
        end body
    end function
    
    function: testControlStructures
        returns: void
        body:
            std_io.println("--- Testing Control Structures ---")
            declare n: int = 10
            if n > 5 then
                std_io.println("n is greater than 5")
            else
                std_io.println("n is not greater than 5")
            end if
            
            std_io.println("Counting from 1 to 3:")
            loop:
                init:
                    declare i: int = 1
                cond:
                    i <= 3
                step:
                    i = i + 1
                body:
                    std_io.println("i = " + i)
                end body
            end loop
        end body
    end function
    
    function: add
        params:
            declare a: int
            declare b: int
        returns: int
        body:
            return a + b
        end body
    end function
    
    function: testFunctions
        returns: void
        body:
            std_io.println("--- Testing Functions ---")
            declare result: int = add(3, 5)
            std_io.println("3 + 5 = " + result)
        end body
    end function
    
    function: testStructs
        returns: void
        body:
            std_io.println("--- Testing Structs ---")
            declare p: Point = new Point(10, 20)
            std_io.println("Point coordinates: (" + p.getX() + ", " + p.getY() + ")")
            
            p.move(5, - 3)
            std_io.println("After move: (" + p.getX() + ", " + p.getY() + ")")
        end body
    end function
    
    function: testInheritance
        returns: void
        body:
            std_io.println("--- Testing Inheritance ---")
            declare cp: ColoredPoint = new ColoredPoint(15, 25, "red")
            std_io.println("Colored point coordinates: (" + cp.getX() + ", " + cp.getY() + ")")
            std_io.println("Colored point color: " + cp.getColor())
            
            cp.move(10, - 5)
            std_io.println("After move: (" + cp.getX() + ", " + cp.getY() + ")")
        end body
    end function
    
    function: testArrays
        returns: void
        body:
            std_io.println("--- Testing Arrays ---")
            declare arr: int[] = [1, 2, 3, 4, 5]
            std_io.println("First element: " + arr[0])
            std_io.println("Third element: " + arr[2])
            
            arr[0] = 10
            std_io.println("Modified first element: " + arr[0])
            
            // 遍历数组
            declare arrLength: int = 5
            loop:
                init:
                    declare i: int = 0
                cond:
                    i < arrLength
                step:
                    i = i + 1
                body:
                    std_io.println("arr[" + i + "] = " + arr[i])
                end body
            end loop
        end body
    end function
    
    function: testMultidimensionalArrays
        returns: void
        body:
            std_io.println("--- Testing Multidimensional Arrays ---")
            declare matrix: int[][] = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
            
            std_io.println("matrix[0][0]: " + matrix[0][0])
            std_io.println("matrix[1][2]: " + matrix[1][2])
            std_io.println("matrix[2][1]: " + matrix[2][1])
            
            matrix[0][0] = 10
            std_io.println("Modified matrix[0][0]: " + matrix[0][0])
            
            // 遍历多维数组
            loop:
                init:
                    declare i: int = 0
                cond:
                    i < 3
                step:
                    i = i + 1
                body:
                    loop:
                        init:
                            declare j: int = 0
                        cond:
                            j < 3
                        step:
                            j = j + 1
                        body:
                            std_io.print(matrix[i][j] + " ")
                        end body
                    end loop
                    std_io.println("")
                end body
            end loop
        end body
    end function
    
    function: testSyscalls
        returns: void
        body:
            std_io.println("--- Testing Syscalls ---")
            declare startTime: long = time.mono_ms()
            std_io.println("Start time: " + startTime)
        end body
    end function
    
    function: testGlobals
        returns: void
        body:
            std_io.println("--- Testing Globals ---")
            std_io.println("Global counter: " + globalCounter)
            globalCounter = globalCounter + 1
            std_io.println("Incremented global counter: " + globalCounter)
        end body
    end function
    
    function: _privateFunction
        returns: string
        body:
            return "This is a private function"
        end body
    end function
    
    function: testAccessControl
        returns: void
        body:
            std_io.println("--- Testing Access Control ---")
            std_io.println("Private function result: " + _privateFunction())
        end body
    end function
end module